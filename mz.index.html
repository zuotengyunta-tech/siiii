<script>
  const apiKey = "AIzaSyAxk1YpQSe-qDtFUSUmnjnduanag41Mlyk"; // 自分のAPIキー
  const playlistId = "PLExT6MVBKs2BOFn2KPX6FYLQ8btIpOZ5l";   // ← 変更後の再生リストID

  const container = document.getElementById("videos");
  const player = document.getElementById("player");

  async function fetchAllVideos(pageToken = "", allItems = []) {
    const url = `https://www.googleapis.com/youtube/v3/playlistItems?part=snippet&maxResults=50&playlistId=${playlistId}&key=${apiKey}&pageToken=${pageToken}`;
    const res = await fetch(url);
    const data = await res.json();

    if (data.items) allItems = allItems.concat(data.items);
    if (data.nextPageToken) return fetchAllVideos(data.nextPageToken, allItems);
    return allItems;
  }

  fetchAllVideos()
    .then(items => {
      container.innerHTML = "";

      items.forEach(item => {
        const title = item.snippet.title;
        const videoId = item.snippet.resourceId.videoId;
        const thumbnail = item.snippet.thumbnails.medium.url;

        const div = document.createElement("div");
        div.className = "video-item";

        div.innerHTML = `
          <img src="${thumbnail}" alt="${title}" />
          <p>${title}</p>
        `;

        div.onclick = () => {
          player.innerHTML = `
            <iframe
              src="https://www.youtube.com/embed/${videoId}?rel=0&modestbranding=1&autoplay=1"
              allow="autoplay; encrypted-media"
              allowfullscreen
            ></iframe>
          `;
        };

        container.appendChild(div);
      });
    })
    .catch(err => {
      container.innerText = "APIエラーが発生しました。";
      console.error(err);
    });
</script>
